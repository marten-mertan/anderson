;'use strict';function BitrixSmallCart(){}BitrixSmallCart.prototype={activate:function(){this.cartElement=BX(this.cartId);this.fixedPosition=this.arParams.POSITION_FIXED=='Y';if(this.fixedPosition){this.cartClosed=true;this.maxHeight=false;this.itemRemoved=false;this.verticalPosition=this.arParams.POSITION_VERTICAL;this.horizontalPosition=this.arParams.POSITION_HORIZONTAL;this.topPanelElement=BX("bx-panel");this.fixAfterRender();this.fixAfterRenderClosure=this.closure('fixAfterRender');var fixCartClosure=this.closure('fixCart');this.fixCartClosure=fixCartClosure;if(this.topPanelElement&&this.verticalPosition=='top')BX.addCustomEvent(window,'onTopPanelCollapse',fixCartClosure);var resizeTimer=null;BX.bind(window,'resize',function(){clearTimeout(resizeTimer);resizeTimer=setTimeout(fixCartClosure,200);});}this.setCartBodyClosure=this.closure('setCartBody');BX.addCustomEvent(window,'OnBasketChange',this.closure('refreshCart',{}));},fixAfterRender:function(){this.statusElement=BX(this.cartId+'status');if(this.statusElement){if(this.cartClosed)this.statusElement.innerHTML=this.openMessage;else
this.statusElement.innerHTML=this.closeMessage;}this.productsElement=BX(this.cartId+'products');this.fixCart();},closure:function(fname,data){var obj=this;return data?function(){obj[fname](data)}:function(arg1){obj[fname](arg1)};},toggleOpenCloseCart:function(){if(this.cartClosed){BX.removeClass(this.cartElement,'bx-closed');BX.addClass(this.cartElement,'bx-opener');this.statusElement.innerHTML=this.closeMessage;this.cartClosed=false;this.fixCart();}else{BX.addClass(this.cartElement,'bx-closed');BX.removeClass(this.cartElement,'bx-opener');BX.removeClass(this.cartElement,'bx-max-height');this.statusElement.innerHTML=this.openMessage;this.cartClosed=true;var itemList=this.cartElement.querySelector("[data-role='basket-item-list']");if(itemList)itemList.style.top="auto";}setTimeout(this.fixCartClosure,100);},setVerticalCenter:function(windowHeight){var top=windowHeight/2-(this.cartElement.offsetHeight/2);if(top<5)top=5;this.cartElement.style.top=top+'px';},fixCart:function(){if(this.horizontalPosition=='hcenter'){var windowWidth='innerWidth'in window?window.innerWidth:document.documentElement.offsetWidth;var left=windowWidth/2-(this.cartElement.offsetWidth/2);if(left<5)left=5;this.cartElement.style.left=left+'px';}var windowHeight='innerHeight'in window?window.innerHeight:document.documentElement.offsetHeight;switch(this.verticalPosition){case'top':if(this.topPanelElement)this.cartElement.style.top=this.topPanelElement.offsetHeight+5+'px';break;case'vcenter':this.setVerticalCenter(windowHeight);break;}if(this.productsElement){var itemList=this.cartElement.querySelector("[data-role='basket-item-list']");if(this.cartClosed){if(this.maxHeight){BX.removeClass(this.cartElement,'bx-max-height');if(itemList)itemList.style.top="auto";this.maxHeight=false;}}else{if(this.maxHeight){if(this.productsElement.scrollHeight==this.productsElement.clientHeight){BX.removeClass(this.cartElement,'bx-max-height');if(itemList)itemList.style.top="auto";this.maxHeight=false;}}else{if(this.verticalPosition=='top'||this.verticalPosition=='vcenter'){if(this.cartElement.offsetTop+this.cartElement.offsetHeight>=windowHeight){BX.addClass(this.cartElement,'bx-max-height');if(itemList)itemList.style.top=82+"px";this.maxHeight=true;}}else{if(this.cartElement.offsetHeight>=windowHeight){BX.addClass(this.cartElement,'bx-max-height');if(itemList)itemList.style.top=82+"px";this.maxHeight=true;}}}}if(this.verticalPosition=='vcenter')this.setVerticalCenter(windowHeight);}},refreshCart:function(data){if(this.itemRemoved){this.quantityChange=true;this.itemRemoved=false;return;}data.sessid=BX.bitrix_sessid();data.siteId=this.siteId;data.templateName=this.templateName;data.arParams=this.arParams;BX.ajax({url:this.ajaxPath,method:'POST',dataType:'html',data:data,onsuccess:this.setCartBodyClosure});},setCartBody:function(result){if(this.cartElement){this.cartElement.innerHTML=result.replace(/#CURRENT_URL#/g,this.currentUrl);changeHeightBasketPopup();if(this.quantityChange){$('.popup-basket').addClass('popup-slide__show');this.quantityChange=false;}}$('.icon-basket, .header .symbol-basket, .header .symbol-basket-2, .header-basket__count').on('click',function(){$('.popup-basket').addClass('popup-slide__show');$('.header').addClass('header-top__no-hide');});$('.popup-basket__close').on('click',function(){$('.popup-basket').removeClass('popup-slide__show');$('.header').removeClass('header-top__no-hide');});if(this.fixedPosition)setTimeout(this.fixAfterRenderClosure,100);},removeItemFromCart:function(id){this.refreshCart({sbblRemoveItemFromCart:id});this.itemRemoved=true;BX.onCustomEvent('OnBasketChange');},changeQuantity:function(id,_this,type){var input=$(_this).parent().find('input');if(type=='up'){var currentNumber=parseInt(input.val());input.val(currentNumber+1);}if(type=='dwn'){var currentNumber=parseInt(input.val());if(currentNumber>=1){input.val(currentNumber-1);}else{return false;}}var q=input.val();clearTimeout(this.loaderTimer);this.quantityChange=true;this.loaderTimer=setTimeout(function(){$.ajax({url:'/local/ajax/add_to_cart.php',method:'POST',data:{cart:id,action:'update',quantity:q},success:function(res){BX.onCustomEvent('OnBasketChange');}});},500);}};;;function JCTitleSearch(arParams){var _this=this;this.arParams={'AJAX_PAGE':arParams.AJAX_PAGE,'CONTAINER_ID':arParams.CONTAINER_ID,'INPUT_ID':arParams.INPUT_ID,'MIN_QUERY_LEN':parseInt(arParams.MIN_QUERY_LEN)};if(arParams.WAIT_IMAGE)this.arParams.WAIT_IMAGE=arParams.WAIT_IMAGE;if(arParams.MIN_QUERY_LEN<=0)arParams.MIN_QUERY_LEN=1;this.cache=[];this.cache_key=null;this.startText='';this.running=false;this.runningCall=false;this.currentRow=-1;this.RESULT=null;this.CONTAINER=null;this.INPUT=null;this.WAIT=null;this.ShowResult=function(result){if(BX.type.isString(result)){_this.RESULT.innerHTML=result;}_this.RESULT.style.display=_this.RESULT.innerHTML!==''?'block':'none';var pos=_this.adjustResultNode();var res_pos;var th;var tbl=BX.findChild(_this.RESULT,{'tag':'table','class':'title-search-result'},true);if(tbl){th=BX.findChild(tbl,{'tag':'th'},true);}if(th){var tbl_pos=BX.pos(tbl);tbl_pos.width=tbl_pos.right-tbl_pos.left;var th_pos=BX.pos(th);th_pos.width=th_pos.right-th_pos.left;th.style.width=th_pos.width+'px';_this.RESULT.style.width=(pos.width+th_pos.width)+'px';_this.RESULT.style.left=(pos.left-th_pos.width-1)+'px';if((tbl_pos.width-th_pos.width)>pos.width)_this.RESULT.style.width=(pos.width+th_pos.width-1)+'px';tbl_pos=BX.pos(tbl);res_pos=BX.pos(_this.RESULT);if(res_pos.right>tbl_pos.right){_this.RESULT.style.width=(tbl_pos.right-tbl_pos.left)+'px';}}var fade;if(tbl)fade=BX.findChild(_this.RESULT,{'class':'title-search-fader'},true);if(fade&&th){res_pos=BX.pos(_this.RESULT);fade.style.left=(res_pos.right-res_pos.left-18)+'px';fade.style.width=18+'px';fade.style.top=0+'px';fade.style.height=(res_pos.bottom-res_pos.top)+'px';fade.style.display='block';}};this.onKeyPress=function(keyCode){var tbl=BX.findChild(_this.RESULT,{'tag':'table','class':'title-search-result'},true);if(!tbl)return false;var i;var cnt=tbl.rows.length;switch(keyCode){case 27:_this.RESULT.style.display='none';_this.currentRow=-1;_this.UnSelectAll();return true;case 40:if(_this.RESULT.style.display=='none')_this.RESULT.style.display='block';var first=-1;for(i=0;i<cnt;i++){if(!BX.findChild(tbl.rows[i],{'class':'title-search-separator'},true)){if(first==-1)first=i;if(_this.currentRow<i){_this.currentRow=i;break;}else if(tbl.rows[i].className=='title-search-selected'){tbl.rows[i].className='';}}}if(i==cnt&&_this.currentRow!=i)_this.currentRow=first;tbl.rows[_this.currentRow].className='title-search-selected';return true;case 38:if(_this.RESULT.style.display=='none')_this.RESULT.style.display='block';var last=-1;for(i=cnt-1;i>=0;i--){if(!BX.findChild(tbl.rows[i],{'class':'title-search-separator'},true)){if(last==-1)last=i;if(_this.currentRow>i){_this.currentRow=i;break;}else if(tbl.rows[i].className=='title-search-selected'){tbl.rows[i].className='';}}}if(i<0&&_this.currentRow!=i)_this.currentRow=last;tbl.rows[_this.currentRow].className='title-search-selected';return true;case 13:if(_this.RESULT.style.display=='block'){for(i=0;i<cnt;i++){if(_this.currentRow==i){if(!BX.findChild(tbl.rows[i],{'class':'title-search-separator'},true)){var a=BX.findChild(tbl.rows[i],{'tag':'a'},true);if(a){window.location=a.href;return true;}}}}}return false;}return false;};this.onTimeout=function(){_this.onChange(function(){setTimeout(_this.onTimeout,500);});};this.onChange=function(callback){if(_this.running){_this.runningCall=true;return;}_this.running=true;if(_this.INPUT.value!=_this.oldValue&&_this.INPUT.value!=_this.startText){_this.oldValue=_this.INPUT.value;if(_this.INPUT.value.length>=_this.arParams.MIN_QUERY_LEN){_this.cache_key=_this.arParams.INPUT_ID+'|'+_this.INPUT.value;if(_this.cache[_this.cache_key]==null){if(_this.WAIT){var pos=BX.pos(_this.INPUT);var height=(pos.bottom-pos.top)-2;_this.WAIT.style.top=(pos.top+1)+'px';_this.WAIT.style.height=height+'px';_this.WAIT.style.width=height+'px';_this.WAIT.style.left=(pos.right-height+2)+'px';_this.WAIT.style.display='block';}BX.ajax.post(_this.arParams.AJAX_PAGE,{'ajax_call':'y','INPUT_ID':_this.arParams.INPUT_ID,'q':_this.INPUT.value,'l':_this.arParams.MIN_QUERY_LEN},function(result){_this.cache[_this.cache_key]=result;_this.ShowResult(result);_this.currentRow=-1;_this.EnableMouseEvents();if(_this.WAIT)_this.WAIT.style.display='none';if(!!callback)callback();_this.running=false;if(_this.runningCall){_this.runningCall=false;_this.onChange();}});return;}else{_this.ShowResult(_this.cache[_this.cache_key]);_this.currentRow=-1;_this.EnableMouseEvents();}}else{_this.RESULT.style.display='none';_this.currentRow=-1;_this.UnSelectAll();}}if(!!callback)callback();_this.running=false;};this.onScroll=function(){if(BX.type.isElementNode(_this.RESULT)&&_this.RESULT.style.display!=="none"&&_this.RESULT.innerHTML!==''){_this.adjustResultNode();}};this.UnSelectAll=function(){var tbl=BX.findChild(_this.RESULT,{'tag':'table','class':'title-search-result'},true);if(tbl){var cnt=tbl.rows.length;for(var i=0;i<cnt;i++)tbl.rows[i].className='';}};this.EnableMouseEvents=function(){var tbl=BX.findChild(_this.RESULT,{'tag':'table','class':'title-search-result'},true);if(tbl){var cnt=tbl.rows.length;for(var i=0;i<cnt;i++)if(!BX.findChild(tbl.rows[i],{'class':'title-search-separator'},true)){tbl.rows[i].id='row_'+i;tbl.rows[i].onmouseover=function(e){if(_this.currentRow!=this.id.substr(4)){_this.UnSelectAll();this.className='title-search-selected';_this.currentRow=this.id.substr(4);}};tbl.rows[i].onmouseout=function(e){this.className='';_this.currentRow=-1;};}}};this.onFocusLost=function(hide){setTimeout(function(){_this.RESULT.style.display='none';},250);};this.onFocusGain=function(){if(_this.RESULT.innerHTML.length)_this.ShowResult();};this.onKeyDown=function(e){if(!e)e=window.event;if(_this.RESULT.style.display=='block'){if(_this.onKeyPress(e.keyCode))return BX.PreventDefault(e);}};this.adjustResultNode=function(){if(!(BX.type.isElementNode(_this.RESULT)&&BX.type.isElementNode(_this.CONTAINER))){return{top:0,right:0,bottom:0,left:0,width:0,height:0};}var pos=BX.pos(_this.CONTAINER);_this.RESULT.style.position='absolute';_this.RESULT.style.top=(pos.bottom+2)+'px';_this.RESULT.style.left=pos.left+'px';_this.RESULT.style.width=pos.width+'px';return pos;};this._onContainerLayoutChange=function(){if(BX.type.isElementNode(_this.RESULT)&&_this.RESULT.style.display!=="none"&&_this.RESULT.innerHTML!==''){_this.adjustResultNode();}};this.Init=function(){this.CONTAINER=document.getElementById(this.arParams.CONTAINER_ID);BX.addCustomEvent(this.CONTAINER,"OnNodeLayoutChange",this._onContainerLayoutChange);this.RESULT=document.body.appendChild(document.createElement("DIV"));this.RESULT.className='title-search-result';this.INPUT=document.getElementById(this.arParams.INPUT_ID);this.startText=this.oldValue=this.INPUT.value;BX.bind(this.INPUT,'focus',function(){_this.onFocusGain()});BX.bind(this.INPUT,'blur',function(){_this.onFocusLost()});this.INPUT.onkeydown=this.onKeyDown;if(this.arParams.WAIT_IMAGE){this.WAIT=document.body.appendChild(document.createElement("DIV"));this.WAIT.style.backgroundImage="url('"+this.arParams.WAIT_IMAGE+"')";if(!BX.browser.IsIE())this.WAIT.style.backgroundRepeat='none';this.WAIT.style.display='none';this.WAIT.style.position='absolute';this.WAIT.style.zIndex='1100';}BX.bind(this.INPUT,'bxchange',function(){_this.onChange()});var fixedParent=BX.findParent(this.CONTAINER,BX.is_fixed);if(BX.type.isElementNode(fixedParent)){BX.bind(window,'scroll',BX.throttle(this.onScroll,100,this));}};BX.ready(function(){_this.Init(arParams)});};;function JCTitleSearchNew(arParams){var _this=this;this.arParams={'AJAX_PAGE':arParams.AJAX_PAGE,'CONTAINER_ID':arParams.CONTAINER_ID,'INPUT_ID':arParams.INPUT_ID,'MIN_QUERY_LEN':parseInt(arParams.MIN_QUERY_LEN)};if(arParams.WAIT_IMAGE)this.arParams.WAIT_IMAGE=arParams.WAIT_IMAGE;if(arParams.MIN_QUERY_LEN<=0)arParams.MIN_QUERY_LEN=1;this.cache=[];this.cache_key=null;this.startText='';this.running=false;this.currentRow=-1;this.RESULT=null;this.CONTAINER=null;this.INPUT=null;this.WAIT=null;this.ShowResult=function(result){if(BX.type.isString(result)){_this.RESULT.innerHTML=result;}_this.RESULT.style.display=_this.RESULT.innerHTML!==''?'block':'none';var pos=_this.adjustResultNode();var res_pos;var th;var tbl=BX.findChild(_this.RESULT,{'tag':'table','class':'title-search-result'},true);if(tbl){th=BX.findChild(tbl,{'tag':'th'},true);}if(th){var tbl_pos=BX.pos(tbl);tbl_pos.width=tbl_pos.right-tbl_pos.left;var th_pos=BX.pos(th);th_pos.width=th_pos.right-th_pos.left;th.style.width=th_pos.width+'px';_this.RESULT.style.width=(pos.width+th_pos.width)+'px';_this.RESULT.style.left=(pos.left-th_pos.width-1)+'px';if((tbl_pos.width-th_pos.width)>pos.width)_this.RESULT.style.width=(pos.width+th_pos.width-1)+'px';tbl_pos=BX.pos(tbl);res_pos=BX.pos(_this.RESULT);if(res_pos.right>tbl_pos.right){_this.RESULT.style.width=(tbl_pos.right-tbl_pos.left)+'px';}}var fade;if(tbl)fade=BX.findChild(_this.RESULT,{'class':'title-search-fader'},true);if(fade&&th){res_pos=BX.pos(_this.RESULT);fade.style.left=(res_pos.right-res_pos.left-18)+'px';fade.style.width=18+'px';fade.style.top=0+'px';fade.style.height=(res_pos.bottom-res_pos.top)+'px';fade.style.display='block';}};this.onKeyPress=function(keyCode){var tbl=BX.findChild(_this.RESULT,{'tag':'table','class':'title-search-result'},true);if(!tbl)return false;var i;var cnt=tbl.rows.length;switch(keyCode){case 27:_this.RESULT.style.display='none';_this.currentRow=-1;_this.UnSelectAll();return true;case 40:if(_this.RESULT.style.display=='none')_this.RESULT.style.display='block';var first=-1;for(i=0;i<cnt;i++){if(!BX.findChild(tbl.rows[i],{'class':'title-search-separator'},true)){if(first==-1)first=i;if(_this.currentRow<i){_this.currentRow=i;break;}else if(tbl.rows[i].className=='title-search-selected'){tbl.rows[i].className='';}}}if(i==cnt&&_this.currentRow!=i)_this.currentRow=first;tbl.rows[_this.currentRow].className='title-search-selected';return true;case 38:if(_this.RESULT.style.display=='none')_this.RESULT.style.display='block';var last=-1;for(i=cnt-1;i>=0;i--){if(!BX.findChild(tbl.rows[i],{'class':'title-search-separator'},true)){if(last==-1)last=i;if(_this.currentRow>i){_this.currentRow=i;break;}else if(tbl.rows[i].className=='title-search-selected'){tbl.rows[i].className='';}}}if(i<0&&_this.currentRow!=i)_this.currentRow=last;tbl.rows[_this.currentRow].className='title-search-selected';return true;case 13:if(_this.RESULT.style.display=='block'){for(i=0;i<cnt;i++){if(_this.currentRow==i){if(!BX.findChild(tbl.rows[i],{'class':'title-search-separator'},true)){var a=BX.findChild(tbl.rows[i],{'tag':'a'},true);if(a){window.location=a.href;return true;}}}}}return false;}return false;};this.onTimeout=function(){_this.onChange(function(){setTimeout(_this.onTimeout,500);});};this.onChange=function(callback){if(_this.running)return;_this.running=true;if(_this.INPUT.value!=_this.oldValue&&_this.INPUT.value!=_this.startText){_this.oldValue=_this.INPUT.value;if(_this.INPUT.value.length>=_this.arParams.MIN_QUERY_LEN){_this.cache_key=_this.arParams.INPUT_ID+'|'+_this.INPUT.value;if(_this.cache[_this.cache_key]==null){if(_this.WAIT){var pos=BX.pos(_this.INPUT);var height=(pos.bottom-pos.top)-2;_this.WAIT.style.top=(pos.top+1)+'px';_this.WAIT.style.height=height+'px';_this.WAIT.style.width=height+'px';_this.WAIT.style.left=(pos.right-height+2)+'px';_this.WAIT.style.display='block';}BX.ajax.post(_this.arParams.AJAX_PAGE,{'ajax_call':'y','INPUT_ID':_this.arParams.INPUT_ID,'q':_this.INPUT.value,'l':_this.arParams.MIN_QUERY_LEN},function(result){_this.cache[_this.cache_key]=result;_this.ShowResult(result);_this.currentRow=-1;_this.EnableMouseEvents();if(_this.WAIT)_this.WAIT.style.display='none';if(!!callback)callback();_this.running=false;});return;}else{_this.ShowResult(_this.cache[_this.cache_key]);_this.currentRow=-1;_this.EnableMouseEvents();}}else{_this.RESULT.style.display='none';_this.currentRow=-1;_this.UnSelectAll();}}if(!!callback)callback();_this.running=false;};this.UnSelectAll=function(){var tbl=BX.findChild(_this.RESULT,{'tag':'table','class':'title-search-result'},true);if(tbl){var cnt=tbl.rows.length;for(var i=0;i<cnt;i++)tbl.rows[i].className='';}};this.EnableMouseEvents=function(){var tbl=BX.findChild(_this.RESULT,{'tag':'table','class':'title-search-result'},true);if(tbl){var cnt=tbl.rows.length;for(var i=0;i<cnt;i++)if(!BX.findChild(tbl.rows[i],{'class':'title-search-separator'},true)){tbl.rows[i].id='row_'+i;tbl.rows[i].onmouseover=function(e){if(_this.currentRow!=this.id.substr(4)){_this.UnSelectAll();this.className='title-search-selected';_this.currentRow=this.id.substr(4);}};tbl.rows[i].onmouseout=function(e){this.className='';_this.currentRow=-1;};}}};this.onFocusLost=function(hide){setTimeout(function(){_this.RESULT.style.display='none';},250);};this.onFocusGain=function(){if(_this.RESULT.innerHTML.length)_this.ShowResult();};this.onKeyDown=function(e){if(!e)e=window.event;if(_this.RESULT.style.display=='block'){if(_this.onKeyPress(e.keyCode))return BX.PreventDefault(e);}};this.adjustResultNode=function(){var pos;var fixedParent=BX.findParent(_this.CONTAINER,BX.is_fixed);if(!!fixedParent){_this.RESULT.style.position='fixed';_this.RESULT.style.zIndex=BX.style(fixedParent,'z-index')+2;pos=BX.pos(_this.CONTAINER,true);_this.RESULT.style.top=(pos.top+40)+'px';}else{_this.RESULT.style.position='absolute';pos=BX.pos(_this.CONTAINER);_this.RESULT.style.top=(pos.top+25)+'px';}pos.left=$(_this.CONTAINER).offset().left;pos.width=pos.right-pos.left;_this.RESULT.style.left=pos.left-168.45+'px';_this.RESULT.style.width=pos.width+'px';return pos;};this._onContainerLayoutChange=function(){if(_this.RESULT.style.display!=="none"&&_this.RESULT.innerHTML!==''){_this.adjustResultNode();}};this.Init=function(){this.CONTAINER=document.getElementById(this.arParams.CONTAINER_ID);BX.addCustomEvent(this.CONTAINER,"OnNodeLayoutChange",this._onContainerLayoutChange);this.RESULT=document.body.appendChild(document.createElement("DIV"));this.RESULT.className='title-search-result';this.INPUT=document.getElementById(this.arParams.INPUT_ID);this.startText=this.oldValue=this.INPUT.value;BX.bind(this.INPUT,'focus',function(){_this.onFocusGain()});BX.bind(this.INPUT,'blur',function(){_this.onFocusLost()});this.INPUT.onkeydown=this.onKeyDown;if(this.arParams.WAIT_IMAGE){this.WAIT=document.body.appendChild(document.createElement("DIV"));this.WAIT.style.backgroundImage="url('"+this.arParams.WAIT_IMAGE+"')";if(!BX.browser.IsIE())this.WAIT.style.backgroundRepeat='none';this.WAIT.style.display='none';this.WAIT.style.position='absolute';this.WAIT.style.zIndex='1100';}BX.bind(this.INPUT,'bxchange',function(){_this.onChange()});};BX.ready(function(){_this.Init(arParams)});};;;(function(){function UserConsentControl(params){this.caller=params.caller;this.formNode=params.formNode;this.controlNode=params.controlNode;this.inputNode=params.inputNode;this.config=params.config;}UserConsentControl.prototype={};BX.UserConsent={msg:{'title':'MAIN_USER_CONSENT_REQUEST_TITLE','btnAccept':'MAIN_USER_CONSENT_REQUEST_BTN_ACCEPT','btnReject':'MAIN_USER_CONSENT_REQUEST_BTN_REJECT','loading':'MAIN_USER_CONSENT_REQUEST_LOADING','errTextLoad':'MAIN_USER_CONSENT_REQUEST_ERR_TEXT_LOAD'},events:{'save':'main-user-consent-request-save','refused':'main-user-consent-request-refused','accepted':'main-user-consent-request-accepted'},textList:{},current:null,autoSave:false,isFormSubmitted:false,isConsentSaved:false,attributeControl:'data-bx-user-consent',load:function(context){var item=this.find(context)[0];if(!item){return null;}this.bind(item);return item;},loadAll:function(context,limit){this.find(context,limit).forEach(this.bind,this);},loadFromForms:function(){var formNodes=document.getElementsByTagName('FORM');formNodes=BX.convert.nodeListToArray(formNodes);formNodes.forEach(this.loadAll,this);},find:function(context){if(!context){return[];}var controlNodes=context.querySelectorAll('['+this.attributeControl+']');controlNodes=BX.convert.nodeListToArray(controlNodes);return controlNodes.map(this.createItem.bind(this,context)).filter(function(item){return!!item});},bind:function(item){if(item.config.submitEventName){BX.addCustomEvent(item.config.submitEventName,this.onSubmit.bind(this,item));}else if(item.formNode){BX.bind(item.formNode,'submit',this.onSubmit.bind(this,item));}BX.bind(item.controlNode,'click',this.onClick.bind(this,item));},createItem:function(context,controlNode){var inputNode=controlNode.querySelector('input[type="checkbox"]');if(!inputNode){return;}try{var config=JSON.parse(controlNode.getAttribute(this.attributeControl));var parameters={'formNode':null,'controlNode':controlNode,'inputNode':inputNode,'config':config};if(context.tagName=='FORM'){parameters.formNode=context;}else{parameters.formNode=BX.findParent(inputNode,{tagName:'FORM'})}parameters.caller=this;return new UserConsentControl(parameters);}catch(e){return null;}},onClick:function(item,e){this.requestForItem(item);e.preventDefault();},onSubmit:function(item,e){this.isFormSubmitted=true;if(this.check(item)){return true;}else{if(e){e.preventDefault();}return false;}},check:function(item){if(item.inputNode.checked){this.saveConsent(item);return true;}this.requestForItem(item);return false;},requestForItem:function(item){this.setCurrent(item);this.requestConsent(item.config.id,{'sec':item.config.sec,'replace':item.config.replace},this.onAccepted,this.onRefused);},setCurrent:function(item){this.current=item;this.autoSave=item.config.autoSave;this.actionRequestUrl=item.config.actionUrl;},onAccepted:function(){if(!this.current){return;}$(this.current.inputNode).prop('checked',true)
var item=this.current;this.saveConsent(this.current,function(){BX.onCustomEvent(item,this.events.accepted,[]);BX.onCustomEvent(this,this.events.accepted,[item]);this.isConsentSaved=true;if(this.isFormSubmitted&&item.formNode&&!item.config.submitEventName){BX.submit(item.formNode);}});this.current.inputNode.checked=true;this.current=null;},onRefused:function(){BX.onCustomEvent(this.current,this.events.refused,[]);BX.onCustomEvent(this,this.events.refused,[this.current]);$(this.current.inputNode).prop('checked',false);this.current.inputNode.checked=false;this.current=null;this.isFormSubmitted=false;},initPopup:function(){if(this.popup){return;}this.popup={};},popup:{isInit:false,caller:null,nodes:{container:null,shadow:null,head:null,loader:null,content:null,textarea:null,buttonAccept:null,buttonReject:null},onAccept:function(){this.hide();BX.onCustomEvent(this,'accept',[]);},onReject:function(){this.hide();BX.onCustomEvent(this,'reject',[]);},init:function(){if(this.isInit){return true;}var tmplNode=document.querySelector('div[data-bx-template]');if(!tmplNode){return false;}var popup=document.createElement('DIV');popup.innerHTML=tmplNode.innerHTML;popup=popup.children[0];if(!popup){return false;}document.body.insertBefore(popup,document.body.children[0]);this.isInit=true;this.nodes.container=popup;this.nodes.shadow=this.nodes.container.querySelector('[data-bx-shadow]');this.nodes.head=this.nodes.container.querySelector('[data-bx-head]');this.nodes.loader=this.nodes.container.querySelector('[data-bx-loader]');this.nodes.content=this.nodes.container.querySelector('[data-bx-content]');this.nodes.textarea=this.nodes.container.querySelector('[data-bx-textarea]');this.nodes.buttonAccept=this.nodes.container.querySelector('[data-bx-btn-accept]');this.nodes.buttonReject=this.nodes.container.querySelector('[data-bx-btn-reject]');this.nodes.buttonAccept.textContent=BX.message(this.caller.msg.btnAccept);this.nodes.buttonReject.textContent=BX.message(this.caller.msg.btnReject);BX.bind(this.nodes.buttonAccept,'click',this.onAccept.bind(this));BX.bind(this.nodes.buttonReject,'click',this.onReject.bind(this));return true;},setTitle:function(text){if(!this.nodes.head){return;}this.nodes.head.textContent=text;},setContent:function(text){if(!this.nodes.textarea){return;}this.nodes.textarea.innerHTML=text;},show:function(isContentVisible){if(typeof isContentVisible=='boolean'){this.nodes.loader.style.display=!isContentVisible?'':'none';this.nodes.content.style.display=isContentVisible?'':'none';}this.nodes.container.style.display='';},hide:function(){this.nodes.container.style.display='none';}},requestConsent:function(id,sendData,onAccepted,onRefused){sendData=sendData||{};sendData.id=id;if(!this.popup.isInit){this.popup.caller=this;if(!this.popup.init()){return;}BX.addCustomEvent(this.popup,'accept',onAccepted.bind(this));BX.addCustomEvent(this.popup,'reject',onRefused.bind(this));}if(this.current&&this.current.config.text){this.textList[id]=this.current.config.text;}if(this.textList.hasOwnProperty(id)){this.setTextToPopup(this.textList[id]);}else{this.popup.setTitle(BX.message(this.msg.loading));this.popup.show(false);this.sendActionRequest('getText',sendData,function(data){this.textList[id]=data.text||'';this.setTextToPopup(this.textList[id]);},function(){this.popup.hide();alert(BX.message(this.msg.errTextLoad));});}},setTextToPopup:function(text){var titleBar='';var textTitlePos=text.indexOf("\n");var textTitleDotPos=text.indexOf(".");textTitlePos=textTitlePos<textTitleDotPos?textTitlePos:textTitleDotPos;if(textTitlePos>=0&&textTitlePos<=100){titleBar=text.substr(0,textTitlePos).trim();titleBar=titleBar.split(".").map(Function.prototype.call,String.prototype.trim).filter(String)[0];}this.popup.setTitle(titleBar?titleBar:BX.message(this.msg.title));this.popup.setContent(text);this.popup.show(true);},saveConsent:function(item,callback){this.setCurrent(item);var data={'id':item.config.id,'sec':item.config.sec,'url':window.location.href};if(item.config.originId){var originId=item.config.originId;if(item.formNode&&originId.indexOf('%')>=0){var inputs=item.formNode.querySelectorAll('input[type="text"], input[type="hidden"]');inputs=BX.convert.nodeListToArray(inputs);inputs.forEach(function(input){if(!input.name){return;}originId=originId.replace('%'+input.name+'%',input.value?input.value:'');});}data.originId=originId;}if(item.config.originatorId){data.originatorId=item.config.originatorId;}BX.onCustomEvent(item,this.events.save,[data]);BX.onCustomEvent(this,this.events.save,[item,data]);if(this.isConsentSaved||!item.config.autoSave){if(callback){callback.apply(this,[]);}}else{this.sendActionRequest('saveConsent',data,callback,callback);}},sendActionRequest:function(action,sendData,callbackSuccess,callbackFailure){callbackSuccess=callbackSuccess||null;callbackFailure=callbackFailure||null;sendData.action=action;sendData.sessid=BX.bitrix_sessid();sendData.action=action;BX.ajax({url:this.actionRequestUrl,method:'POST',data:sendData,timeout:10,dataType:'json',processData:true,onsuccess:BX.proxy(function(data){data=data||{};if(data.error){callbackFailure.apply(this,[data]);}else if(callbackSuccess){callbackSuccess.apply(this,[data]);}},this),onfailure:BX.proxy(function(){var data={'error':true,'text':''};if(callbackFailure){callbackFailure.apply(this,[data]);}},this)});}};BX.ready(function(){BX.UserConsent.loadFromForms();});})();;;$(document).on('change','#contact-us-theme',function(){$('input[name=form_hidden_116]').val($(this).find('option:selected').html());$('input[name=form_hidden_117]').val($(this).val());});;;window.send_form=false;$(document).ready(function(e){$('form[name="SIMPLE_FORM_6"]').submit(function(){showLoader();})});;;;;;;;